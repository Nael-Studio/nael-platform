---
title: 'Cookies Â· Techniques'
description: 'Read and write HTTP cookies safely in Nael apps, including multi-tenant prefixes with Better Auth.'
---

import Link from 'next/link';
import { Badge } from '@/components/ui/badge';
import { CodeBlock } from '@/components/shared/simple-code-block';

export const readCookies = `import { Controller, Get, Req } from '@nl-framework/http';

@Controller('/profile')
export class ProfileController {
  @Get('/')
  me(@Req() req: Request) {
    const cookieHeader = req.headers.get('cookie') ?? '';
    const cookies = Object.fromEntries(
      cookieHeader
        .split(';')
        .map((pair) => pair.trim())
        .filter(Boolean)
        .map((pair) => pair.split('=').map(decodeURIComponent) as [string, string]),
    );

    return { userId: cookies['session_id'] ?? null };

  }
}`;

export const setCookie = `import { Controller, Post } from '@nl-framework/http';

@Controller('/auth')
export class AuthController {
  @Post('/login')
  async login(): Promise<Response> {
    const body = JSON.stringify({ ok: true });
    return new Response(body, {
      status: 200,
      headers: {
        'content-type': 'application/json',
        // Secure, HttpOnly, SameSite for safety
        'set-cookie': [
          \`session_id=\${encodeURIComponent('abc123')}; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=86400\`,
        ],
      },
    });
  }
}`;

export const clearCookie = `// Overwrite with expired cookie
const expireCookie = 'session_id=; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=0';
return new Response(JSON.stringify({ ok: true }), {
  headers: { 'set-cookie': expireCookie },
});`;

export const multiTenant = `// With Better Auth multi-tenant loader, set a per-tenant prefix (e.g., mt-acme.session_token)
// in your tenant resolver so cookies stay isolated:
return {
  betterAuth: { /* ... */ },
  adapter,
  advanced: { cookiePrefix: \`mt-\${tenantId}\` },
};`;

<article className="space-y-8">
      <div className="space-y-3">
        <Badge className="bg-rose-100 text-rose-900 dark:bg-rose-900/30 dark:text-rose-50">
          Techniques
        </Badge>
        <h1 className="text-4xl font-semibold tracking-tight">Cookies</h1>
        <div className="text-lg text-muted-foreground">
          Use the native `Request`/`Response` APIs to manage cookies in Nael HTTP handlers. Parse
          inbound cookies, set secure flags on responses, and isolate tenant cookies when using Better Auth.
        </div>
      </div>

      <section className="space-y-4" id="read">
        <h2 className="text-2xl font-semibold">Read cookies</h2>
        <div className="text-muted-foreground">
          Access cookies via `req.headers.get('cookie')`. Parse into a map for easy lookup:
        </div>
        <CodeBlock code={readCookies} title="Reading cookies" />
      </section>

      <section className="space-y-4" id="write">
        <h2 className="text-2xl font-semibold">Set and clear cookies</h2>
        <div className="text-muted-foreground">
          Write `Set-Cookie` headers directly. Always include `HttpOnly`, `Secure`,
          and an appropriate `SameSite` value (`Lax` for most API cookies; `None` when shared across origins with `Secure`).
        </div>
        <CodeBlock code={setCookie} title="Setting cookies in a handler" />
        <CodeBlock code={clearCookie} title="Clearing a cookie" />
      </section>

      <section className="space-y-4" id="multi-tenant">
        <h2 className="text-2xl font-semibold">Multi-tenant isolation</h2>
        <div className="text-muted-foreground">
          Better Auth supports per-tenant cookie prefixes. Set `cookiePrefix` in the tenant resolver to keep
          session cookies distinct across tenants.
        </div>
        <CodeBlock code={multiTenant} title="Tenant-specific cookie prefixes" />
      </section>

      <section className="space-y-3" id="tips">
        <h2 className="text-2xl font-semibold">Best practices</h2>
        <ul className="list-disc space-y-2 pl-6 text-muted-foreground">
          <li>Always set <code>HttpOnly</code> and <code>Secure</code> on session cookies; use <code>SameSite=Lax</code> unless cross-site by design.</li>
          <li>Prefer <code>Max-Age</code> over <code>Expires</code> for modern clients; keep lifetimes short for sensitive tokens.</li>
          <li>Normalize domains/paths per environment; avoid sharing cookies across unrelated subdomains.</li>
          <li>Log cookie names, not values; never log secrets.</li>
          <li>For SPA usage, consider Better Auth&apos;s JS client and set <code>SameSite=None</code> with TLS when running on a different origin.</li>
        </ul>
        <div className="text-sm text-muted-foreground">
          See <Link className="text-primary underline" href="/docs/techniques/better-auth">Better Auth</Link> for full
          session guidance and multi-tenant examples.
        </div>
      </section>
    </article>
